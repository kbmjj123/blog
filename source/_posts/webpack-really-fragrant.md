---
title: webpackçœŸé¦™
description: webpackçœŸé¦™
author: Zhenggl
date: 2022-04-13 09:42:09
categories:
    - [å·¥å…·æ’ä»¶, æ‰“åŒ…å·¥å…·, webpack]
tags:
    - æ‰“åŒ…å·¥å…·
    - webpack
cover_picture: webpackçœŸé¦™å°é¢.jpeg
---

### å‰è¨€
> åœ¨ç›®å‰å‰ç«¯å¿«é€Ÿå‘å±•çš„æƒ…å†µä¸‹ï¼Œä»¥å‰å°±æ˜¯ç®€å•åœ°ä¼šå»ä½¿ç”¨åˆ«äººçš„è„šæ‰‹æ¶æ¥æ­å»ºé¡¹ç›®ï¼Œç„¶ååœ¨é¡¹ç›®ä¸­è¿›è¡Œä¸šåŠ¡çš„å¼€å‘ï¼Œä½†æ˜¯æ…¢æ…¢åœ°ï¼Œéšç€ä¸šåŠ¡çš„æ­£å¸¸å‘å±•ï¼Œä¼šå‘ç°
> åŸæœ¬çš„è„šæ‰‹æ¶å¥½åƒå·²ç»ä¸èƒ½å¤Ÿæ»¡è¶³å½“å‰çš„ä¸šåŠ¡ï¼Œéœ€è¦åœ¨ç›®å‰é¡¹ç›®ä¸Šè¿›è¡Œä¸€ä¸ªä¼˜åŒ–å·¥ä½œï¼Œä½†æ˜¯åŸºæœ¬ä¸Šå¤§éƒ¨åˆ†éƒ½æ˜¯ä¸æ¸…æ¥šè„šæ‰‹æ¶é‡Œé¢éƒ½æœ‰ä»€ä¹ˆé…ç½®ï¼Œä¹Ÿä¸çŸ¥é“é¡¹ç›®ä¸­
> çš„é…ç½®éƒ½ç”¨æ¥å¹²å˜›ï¼Œéƒ½æœ‰ä»€ä¹ˆç”¨é€”ï¼Œé‚£ä¹ˆæ€èƒ½å¤Ÿå»ç«™åœ¨è¿™ä¸ªè„šæ‰‹æ¶çš„ä¸Šé¢ï¼Œæ¥ç†è§£å¹¶ä¼˜åŒ–é¡¹ç›®çš„æ¶æ„å‘¢ï¼Ÿ
>
> å¦‚æœè¿åŸºæœ¬çš„å…³äºwebpackçŸ¥è¯†ç‚¹éƒ½ä¸æ¸…æ¥šï¼Œä¸èƒ½å¼„æ‡‚å…¶ä¸­çš„åŸç†ï¼Œåˆæ€èƒ½å»æ»¡è¶³æ—¥ç›Šæ›¾é•¿çš„ä¸šåŠ¡å‘å±•ï¼Œæ¥æ‰“é€ é€‚åˆé¡¹ç›®ä¸šåŠ¡çš„å®Œç¾æ–¹æ¡ˆå‘¢ï¼Ÿ
>
> æœ¬æ–‡ä»¥é»„é‡‘åœˆè§„åˆ™æ¥ç®€å•é˜è¿°ï¼Œç”¨ä»¥å‘Šè¯«è‡ªå·±ä¹Ÿé¡ºä¾¿æé†’è‡ªå·±å­¦ä¹ webpackçš„ä¸€ä¸ªåˆè¡·ï¼ï¼ï¼

![webpackæµç¨‹](webpackæµç¨‹.png)

### ğŸ¤”ä»€ä¹ˆæ˜¯webpack
> `webpack`æ˜¯ä¸€ä¸ªç°åœ¨*é™æ€æ¨¡å—æ‰“åŒ…å·¥å…·*ï¼Œé’ˆå¯¹jsåº”ç”¨ç¨‹åº(ä»»ä½•ä½¿ç”¨jsæ¥ç¼–å†™çš„é¡¹ç›®ï¼Œæ¯”å¦‚reactã€vueã€react-nativeã€æ™®é€šjsã€electronç­‰ç­‰)ï¼Œ
> å½“webpackå¤„ç†åº”ç”¨ç¨‹åºæ—¶ï¼Œå®ƒä¼šåœ¨å†…éƒ¨ä»ä¸€ä¸ªæˆ–è€…å¤šä¸ªå…¥å£ç‚¹å¼€å§‹ï¼Œå°†å…¥å£æ–‡ä»¶æ‰€å¼•ç”¨åˆ°çš„èµ„æºä¾èµ–"å˜æˆ"ä¸€æ£µä¾èµ–æ ‘ï¼Œæ ‘çš„æ ¹å°±æ—¶å…¥å£æ–‡ä»¶ï¼Œä»æ ¹å‡ºå‘ï¼Œ
> æ‰€ä¾èµ–çš„æ¯ä¸€ä¸ªæ¨¡å—å°±å½“ä½œæ—¶æ ‘ä¸Šçš„"æå¶"ï¼Œå°†è¿™äº›æ¨¡å—ç»„åˆæˆä¸ºä¸€ä¸ªæˆ–è€…å¤šä¸ªbundlesï¼Œè€ŒwebpackåŸæœ¬åªæœ‰æ”¯æŒ*js+json*æ‰“åŒ…çš„ï¼Œä½†æ˜¯é¡¹ç›®ä¸­ä¸€èˆ¬éƒ½ä¼š
> ä½¿ç”¨åˆ°å…¶ä»–çš„èµ„æº(æ¯”å¦‚å›¾ç‰‡ã€cssç­‰ç­‰)ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œåˆ™éœ€è¦å€ŸåŠ©äº`loader`äº†ï¼Œloaderå¯¹è±¡å®šä¹‰åœ¨é…ç½®æ–‡ä»¶çš„`module`å±æ€§ä¸­ï¼Œä»¥ruleä½œä¸ºå…³é”®è¯çš„ä¸€ä¸ª
> æ•°ç»„ï¼Œå…¶ç›®çš„æ—¶å‘Šè¯‰webpackåœ¨é‡åˆ°ç¬¦åˆç±»å‹çš„æ–‡ä»¶çš„æ—¶å€™ï¼Œå°†é‡‡ç”¨loaderå®šä¹‰çš„åŠ è½½å™¨æ¥åŠ è½½å¯¹åº”çš„æ–‡ä»¶ï¼Œç„¶åå†ä½¿ç”¨å…¬å…±çš„`require/import`çš„æ–¹å¼æ¥åŠ è½½
> åˆ°å¯¹åº”çš„ä¾èµ–ï¼Œè€Œå…¶ä¸­æ‰€æä¾›çš„æ‰€æä¾›çš„`plugin`æ’ä»¶ï¼Œå°±æ˜¯ç”¨æ¥è¾…åŠ©æ‰“åŒ…ï¼Œå¹¶æ§åˆ¶æ‰“åŒ…è¿‡ç¨‹ã€æ‰“åŒ…ç»“æœçš„å¯¹è±¡ã€‚

æ ¹æ®å®˜ç½‘æ–‡æ¡£å¯¹åº”ç¼–å†™äº†1âƒ£ï¸ç®€å•çš„webpackå…¥é—¨é¡¹ç›®(å¦‚ä¸‹æ‰€ç¤º)ï¼š
![webpackä¾‹å­](webpackä¾‹å­.png)

é’ˆå¯¹ä¸Šè¿°ä¾‹å­ï¼Œæ‰§è¡Œå¯¹åº”çš„å‘½ä»¤ï¼š
> webpack
åˆ™ä¼šè‡ªåŠ¨å¯»æ‰¾å¯¹åº”çš„`webpack.config.js`æ–‡ä»¶è¿›è¡Œè§£æ
![webpackä¾‹å­åŸç†è§£æ](webpackä¾‹å­åŸç†è§£æ.png)

### ğŸ¤”ä¸ºä»€ä¹ˆè¦å­¦ä¹ webpack
> å¦‚æœæˆ‘ä»¬å¹³æ—¶æ­£å¸¸ä½¿ç”¨ä¼ ç»Ÿæ–¹å¼æ¥å¼€å‘webåº”ç”¨ç¨‹åºçš„è¯ï¼Œéšç€é¡¹ç›®è¶Šæ¥è¶Šå¤§ï¼Œå•çº¯é€šè¿‡æ‰‹åŠ¨éƒ¨ç½²ï¼Œè¦†ç›–æ–‡ä»¶è¿›è¡Œéƒ¨ç½²çš„æ–¹å¼çš„è¯ï¼Œä¼°è®¡æƒ³æ­»çš„â¤ï¸éƒ½ğŸˆ¶ï¸äº†ï¼Œè€Œä¸”ä¹Ÿæ— æ³•äº«å—åˆ°
> æ¨¡å—ç¼–ç¨‹ï¼Œé’ˆå¯¹ä»»ä½•èµ„æºçš„æ¨¡å—ç¼–ç¨‹ã€ä¸€é”®ç›˜éƒ¨ç½²ã€å¯¹é¡¹ç›®çš„æ¶æ„è¿›è¡Œé«˜åº¦å®šåˆ¶åŒ–çš„æœåŠ¡ï¼Œä¸€æ—¦æˆ‘ä»¬ä½¿ç”¨äº†`webpack`ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥æ›´å¥½çš„æ¥ç®¡ç†è‡ªå·±çš„é¡¹ç›®ï¼Œå°†é‚£äº›ç¹ççš„ã€
> åˆè‡­åˆé•¿çš„é€»è¾‘æ“ä½œï¼Œéƒ½äº¤ç»™webpackæ¥åšï¼Œå°†å·¥ä½œçš„ä¸­å¿ƒæ”¾åˆ°ä¸šåŠ¡çš„å®ç°ä¸è·Ÿè¿›ä¸Šæ¥ã€‚
> åªæœ‰ä»æ ¹æœ¬ä¸Šç†è§£äº†`webpack`çš„å·¥ä½œåŸç†ï¼Œç”šè‡³äºï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å¼€å‘è‡ªå®šä¹‰çš„`Loader`æˆ–è€…`Plugin`ï¼Œæ¥æ»¡è¶³é¡¹ç›®ä¸šåŠ¡éœ€æ±‚ï¼ï¼ï¼
>
> 1. commonJSå¼•å…¥äº†`require`æœºåˆ¶ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨å½“å‰æ–‡ä»¶ä¸­åŠ è½½å’Œä½¿ç”¨æŸä¸ªæ¨¡å—ï¼Œå¯¼å…¥éœ€è¦çš„æ¯ä¸ªæ¨¡å—ï¼Œå¸®åŠ©æˆ‘ä»¬è§£å†³äº†ä½œç”¨åŸŸé—®é¢˜ã€‚
> 2. npm + node.js + modules = å¤§è§„æ¨¡åˆ†å‘æ¨¡å—

### ğŸ¤”å¦‚ä½•æ¥å­¦ä¹ webpack
âœ¨ æ—¢ç„¶webpackæ˜¯ä¸€ä¸ªå·¥å…·ï¼Œé‚£ä¹ˆå¯¹åº”çš„å­¦ä¹ æ–¹å¼è‚¯å®šæ˜¯çº¿ä¸Šå·¥å…·/æ–‡æ¡£çš„å­¦ä¹ ï¼Œé€šè¿‡å¯¹å…¶å·¥ä½œåŸç†ã€ä»£ç åˆ†æï¼Œä»ä½¿ç”¨åˆ°æºç è§£è¯»ï¼Œäº†è§£å…³äºwebpackä¸­æ‰€æ¶‰åŠçš„ç›¸å…³æ¦‚å¿µã€
APIã€Loaderã€Pluginçš„é…åˆï¼Œæ¥æ·±å…¥å­¦ä¹ å¦‚ä½•ä½¿ç”¨webpackæ¥æ‰“åŒ…è‡ªå·±çš„é¡¹ç›®ï¼Œä¸€æ­¥æ­¥åœ°ä¼˜åŒ–é¡¹ç›®çš„æ‰“åŒ…å·¥ä½œï¼Œæä¾›å·¥ä½œå¼€å‘æ•ˆç‡ï¼ï¼ï¼
![webpackæˆå‘˜](webpackæˆå‘˜.png)

#### ç›¸å…³çš„æ¦‚å¿µï¼š

##### æ¨¡å—(Modules)
> åœ¨æ¨¡å—åŒ–ç¼–ç¨‹ä¸­ï¼Œå¼€å‘è€…å°†ç¨‹åºåˆ†è§£ä¸ºåŠŸèƒ½ç¦»æ•£çš„`chunk`ï¼Œå¹¶ç§°ä¹‹ä¸º**æ¨¡å—**ã€‚
> æ¯ä¸ªæ¨¡å—éƒ½æ‹¥æœ‰å°äºå®Œæ•´ç¨‹åºçš„ä½“ç§¯ï¼Œä½¿å¾—éªŒè¯ã€è°ƒè¯•ä»¥åŠæµ‹è¯•å˜å¾—è½»è€Œæ˜“ä¸¾ï¼Œç²¾å¿ƒç¼–å†™çš„**æ¨¡å—**æä¾›äº†å¯é çš„æŠ½è±¡å’Œå°è£…ç•Œé™

ğŸ¤” å…³äºchunkçš„ç†è§£ï¼Œå¯ä»¥è¿™æ ·å­ç®€å•åœ°æ¥ç†è§£ï¼šé¡¹ç›®ä¸­ä½¿ç”¨çš„æ¯ä¸ªæ–‡ä»¶éƒ½æ˜¯ä¸€ä¸ªchunkï¼Œé€šè¿‡chunkçš„äº’ç›¸å¼•ç”¨ï¼Œè¿™äº›chunkä¼šå½¢æˆä¸€ä¸ªå›¾æ•°æ®ç»“æ„ï¼Œ
è€Œåœ¨æ‰“åŒ…çš„è¿‡ç¨‹ä¸­ï¼Œchunkä¼šè¢«åˆå¹¶æˆä¸º**chunkç»„**ï¼Œå¹¶å½¢æˆä¸€ä¸ªé€šè¿‡æ¨¡å—äº’ç›¸é“¾æ¥çš„å›¾ã€‚æ¯”å¦‚æœ‰ä»¥ä¸‹ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼š
```js
  // webpack.config.js
  module.exports = {
	entry: './index.js'
  };
```
é’ˆå¯¹ğŸ‘†çš„é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡`webpack`å·¥å…·æ‰“åŒ…å‡ºæ¥çš„**chunk**åº”è¯¥æ˜¯æ€æ ·çš„å‘¢ï¼Ÿ

ğŸ‘‰ æ­¤æ—¶ä¼šåˆ›å»ºä¸€ä¸ªåä¸º`main`çš„chunkç»„(å› ä¸ºmainæ˜¯å…¥å£èµ·ç‚¹çš„é»˜è®¤åç§°)ï¼Œæ­¤chunkç»„åŒ…å«`./index.js`æ¨¡å—ï¼Œç„¶åéšç€webpackçš„parserè§£æå™¨åœ¨å¤„ç†`./index.js`å†…éƒ¨çš„*import*æ—¶ï¼Œ
æ–°çš„chunkæ¨¡å—å°±ä¼šè¢«æ·»åŠ åˆ°è¿™ä¸ªchunkç»„ä¸­
> è¿™é‡Œä¹ŸåŒæ—¶è¯´æ˜äº†ä¸€ä¸ªæƒ…å†µï¼šå¦‚æœåœ¨ä½¿ç”¨ä¹‹å‰æ²¡æœ‰åšä»»ä½•çš„é¢å¤–çš„åŠ¨ä½œçš„è¯ï¼Œä¸€ä¸ªchunkç»„ä¸­å¯èƒ½æœ‰å¤šä¸ªchunkï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`SplitChunksPlugin`æ’ä»¶æ¥å°†ä¸€ä¸ªchunkæ‹†åˆ†ä¸ºä¸€ä¸ªæˆ–è€…å¤šä¸ªchunk

âœ¨ é€šè¿‡å¯¹ä¸Šè¿°ä¸­chunkç»„çš„ç†è§£ï¼Œåº”è¯¥å¯ä»¥æ˜¯åœ¨æ—¥å¸¸çš„ç¼–ç¨‹ä¸­ï¼Œå¦‚æœæƒ³è¦ä¼˜åŒ–æ‰“åŒ…å‡ºæ¥çš„jsè¿‡å¤§çš„å…¶ä¸­ä¸€ä¸ªå°ç‚¹ï¼Œå¯ä»¥è€ƒè™‘å°†å…¥å£æ‰€å½¢æˆçš„*chunk/chunkç»„*æ‰€å½¢æˆçš„bundleå›¾ç»™è¿›è¡Œç¼©å‡ï¼Œå°†èµ„æºè°ƒæ•´ä¸ºæŒ‰éœ€åŠ è½½ï¼Œ
æˆ–è€…æ˜¯åŠ¨æ€åŠ è½½ï¼Œä¹Ÿå°±æ˜¯åœ¨è¿˜æœªä½¿ç”¨åˆ°çš„æ—¶å€™ï¼Œä¸é‡‡ç”¨é™æ€å¯¼å…¥åŠ è½½çš„æ–¹å¼ï¼Œæ‰æ˜¯é‡‡ç”¨åœ¨éœ€è¦çš„æ—¶å€™æ‰æ¥å¯¼å…¥è°ƒç”¨ï¼Œåœ¨ä¸å½±å“åˆ°äº¤äº’ä»¥åŠä¸šåŠ¡çš„æƒ…å†µä¸‹ï¼ï¼ï¼ï¼

ğŸŒŸ chunkæœ‰ä¸¤ç§å½¢å¼ï¼š
1. initial(åˆå§‹åŒ–)ï¼šä¹Ÿå°±æ˜¯ä¸Šè¿°çš„å…¥å£èµ·ç‚¹çš„main chunkï¼Œæ­¤chunkåŒ…å«ä¸ºå…¥å£èµ·ç‚¹æŒ‡å®šçš„æ‰€æœ‰æ¨¡å—ä»¥åŠå…¶ä¾èµ–æ¨¡å—
2. non-initial(å»¶è¿ŸåŠ è½½çš„chunk)ï¼šå»¶è¿ŸåŠ è½½çš„chunkï¼Œæ¯”å¦‚åŠ¨æ€å¯¼å…¥æˆ–è€…æ˜¯æ‹†åˆ†æ¨¡å—å¯¼å…¥

æ¯”å¦‚æœ‰ğŸ‘‡çš„ä¸€ä¸ªç®€å•ä¾‹å­ï¼Œä¾‹å­ä¸­çš„ä¾èµ–å…³ç³»å¦‚ä¸‹ï¼š
> index.js -> foo.js -> xx.css
>          -> bar.js

è¿™é‡Œå¯¹äºfoo.jsä»¥åŠbar.jsçš„å¼•ç”¨æœºåˆ¶ä¸ä¸€æ ·çš„ï¼Œfoo.jsé‡‡ç”¨çš„é™æ€ä¾èµ–ï¼Œè€Œbar.jsé‡‡ç”¨çš„åŠ¨æ€ä¾èµ–ï¼Œå› æ­¤ç”Ÿæˆçš„chunk.jsä¸­ï¼Œindex.js + foo.js + xx.css = main-chunkæ‰€åœ¨çš„ç»„ä¸­ï¼Œè€Œbar.jså±äºå•ç‹¬çš„ä¸€ä¸ªchunkç»„

![webpackä¸­çš„chunkä¾èµ–](webpackä¸­çš„chunkä¾èµ–.png)

### ğŸ¤”è¯¾é¢˜é¢„ç•™ï¼šå¦‚ä½•æ ¹æ®å­¦ä¹ çš„webpackæ¥ä¼˜åŒ–è‡ªå·±ç›®å‰çš„é¡¹ç›®
